<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="870px" preserveAspectRatio="none" style="width:1691px;height:870px;background:#FFFFFF;" version="1.1" viewBox="0 0 1691 870" width="1691px" zoomAndPan="magnify"><defs><filter height="300%" id="f1js0ldtt2aadq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="676.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="54" y="99.6094"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="161.5" y="121.9609"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="614.6797" style="stroke:#A80036;stroke-width:1.0;" width="10" x="333.5" y="152.3125"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="553.9766" style="stroke:#A80036;stroke-width:1.0;" width="10" x="601.5" y="182.6641"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1468" y="299.0703"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="448.9219" style="stroke:#000000;stroke-width:2.0;" width="1142" x="423" y="258.3672"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="356.2188" style="stroke:#000000;stroke-width:2.0;" width="958" x="433" y="344.0703"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="135.7578" style="stroke:#000000;stroke-width:2.0;" width="716" x="449" y="486.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="59" x2="59" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="166" x2="166" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="338" x2="338" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="606" x2="606" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="740" x2="740" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="848" x2="848" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1036" x2="1036" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1205" x2="1205" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1318" x2="1318" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1473" x2="1473" y1="89.6094" y2="784.9922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1623" x2="1623" y1="89.6094" y2="784.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="5" y="86.5332">Registered User</text><ellipse cx="59" cy="15" fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M59,23 L59,50 M46,31 L72,31 M59,50 L46,65 M59,50 L72,65 " fill="none" filter="url(#f1js0ldtt2aadq)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="5" y="798.5254">Registered User</text><ellipse cx="59" cy="811.6016" fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M59,819.6016 L59,846.6016 M46,827.6016 L72,827.6016 M59,846.6016 L46,861.6016 M59,846.6016 L72,861.6016 " fill="none" filter="url(#f1js0ldtt2aadq)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="83" x="123" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="130" y="56.9238">&lt;&lt;REST&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="154" y="74.5332">API</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="83" x="123" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="130" y="805.5254">&lt;&lt;REST&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21" x="154" y="823.1348">API</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="161" x="256" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="277" y="56.9238">&lt;&lt;API Controller&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="263" y="74.5332">RelationshipsController</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="161" x="256" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="119" x="277" y="805.5254">&lt;&lt;API Controller&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="263" y="823.1348">RelationshipsController</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="145" x="532" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="539" y="56.9238">&lt;&lt;Domain Service&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="542" y="74.5332">RelationshipService</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="145" x="532" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="131" x="539" y="805.5254">&lt;&lt;Domain Service&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125" x="542" y="823.1348">RelationshipService</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="94" x="691" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="698" y="56.9238">&lt;&lt;Domain&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="718" y="74.5332">Player</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="94" x="691" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="698" y="805.5254">&lt;&lt;Domain&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="718" y="823.1348">Player</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="94" x="799" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="806" y="56.9238">&lt;&lt;Domain&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="807" y="74.5332">Relationship</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="94" x="799" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="806" y="805.5254">&lt;&lt;Domain&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="807" y="823.1348">Relationship</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="233" x="918" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1003.5" y="56.9238">&lt;&lt;DTO&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="925" y="74.5332">NetworkFromPlayerPerspectiveDto</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="233" x="918" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1003.5" y="805.5254">&lt;&lt;DTO&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="219" x="925" y="823.1348">NetworkFromPlayerPerspectiveDto</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1165" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1172" y="56.9238">&lt;&lt;DTO&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1172" y="74.5332">PlayerDto</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="76" x="1165" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1172" y="805.5254">&lt;&lt;DTO&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="1172" y="823.1348">PlayerDto</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="122" x="1255" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1263" y="56.9238">&lt;&lt;Persistence&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1262" y="74.5332">PlayerRepository</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="122" x="1255" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1263" y="805.5254">&lt;&lt;Persistence&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="1262" y="823.1348">PlayerRepository</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="160" x="1391" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1418" y="56.9238">&lt;&lt;Persistence&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="1398" y="74.5332">RelationshipRepository</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="160" x="1391" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1418" y="805.5254">&lt;&lt;Persistence&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146" x="1398" y="823.1348">RelationshipRepository</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="112" x="1565" y="35.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1572" y="56.9238">&lt;&lt;DbContext&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1585" y="74.5332">UnitOfWork</text><rect fill="#FEFECE" filter="url(#f1js0ldtt2aadq)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="112" x="1565" y="783.9922"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="1572" y="805.5254">&lt;&lt;DbContext&gt;&gt;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1585" y="823.1348">UnitOfWork</text><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="676.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="54" y="99.6094"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="30.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="161.5" y="121.9609"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="614.6797" style="stroke:#A80036;stroke-width:1.0;" width="10" x="333.5" y="152.3125"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="553.9766" style="stroke:#A80036;stroke-width:1.0;" width="10" x="601.5" y="182.6641"/><rect fill="#FFFFFF" filter="url(#f1js0ldtt2aadq)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1468" y="299.0703"/><polygon fill="#A80036" points="149.5,117.9609,159.5,121.9609,149.5,125.9609,153.5,121.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="155.5" y1="121.9609" y2="121.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="71" y="117.1045">PUT Player</text><polygon fill="#A80036" points="321.5,148.3125,331.5,152.3125,321.5,156.3125,325.5,152.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="166.5" x2="327.5" y1="152.3125" y2="152.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="173.5" y="147.4561">GetNetwork(email,depth)</text><polygon fill="#A80036" points="589.5,178.6641,599.5,182.6641,589.5,186.6641,593.5,182.6641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="343.5" x2="595.5" y1="182.6641" y2="182.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="350.5" y="177.8076">GetNetworkAtDepthByEmail(email,depth)</text><polygon fill="#A80036" points="1306,209.0156,1316,213.0156,1306,217.0156,1310,213.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1312" y1="213.0156" y2="213.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="618.5" y="208.1592">player=GetByEmailAsync(email)</text><polygon fill="#A80036" points="1024.5,239.3672,1034.5,243.3672,1024.5,247.3672,1028.5,243.3672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="611.5" x2="1030.5" y1="243.3672" y2="243.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="618.5" y="238.5107">network=create(player.email,...)</text><path d="M423,258.3672 L496,258.3672 L496,266.3672 L486,276.3672 L423,276.3672 L423,258.3672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="448.9219" style="stroke:#000000;stroke-width:2.0;" width="1142" x="423" y="258.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="438" y="272.8623">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="183" x="511" y="271.7861">[until selected depth is achieved]</text><polygon fill="#A80036" points="1456,295.0703,1466,299.0703,1456,303.0703,1460,299.0703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1462" y1="299.0703" y2="299.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="618.5" y="294.2139">relationships=GetRelationshipsFriendsById(playerId)</text><path d="M433,344.0703 L506,344.0703 L506,352.0703 L496,362.0703 L433,362.0703 L433,344.0703 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="356.2188" style="stroke:#000000;stroke-width:2.0;" width="958" x="433" y="344.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="448" y="358.5654">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="174" x="521" y="357.4893">[for every player's relationship]</text><polygon fill="#A80036" points="1306,380.7734,1316,384.7734,1306,388.7734,1310,384.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1312" y1="384.7734" y2="384.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="618.5" y="379.917">playerDest=GetByIdAsync(relationship.PlayerDest)</text><path d="M480,397.7734 L480,439.7734 L729,439.7734 L729,407.7734 L719,397.7734 L480,397.7734 " fill="#FBFB77" filter="url(#f1js0ldtt2aadq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M719,397.7734 L719,407.7734 L729,407.7734 L719,397.7734 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="486" y="416.2686">this DTO only contains the basic data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="486" y="432.6201">(user's email, name and relationship ID)</text><polygon fill="#A80036" points="1024.5,467.8281,1034.5,471.8281,1024.5,475.8281,1028.5,471.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="611.5" x2="1030.5" y1="471.8281" y2="471.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401" x="618.5" y="466.9717">subnetwork=create(playerDest.email,playerDest.name,relationship.id)</text><path d="M449,486.8281 L510,486.8281 L510,494.8281 L500,504.8281 L449,504.8281 L449,486.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="135.7578" style="stroke:#000000;stroke-width:2.0;" width="716" x="449" y="486.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="464" y="501.3232">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="256" x="525" y="500.2471">[current relationship includes selected player]</text><path d="M459,510.1797 L459,552.1797 L749,552.1797 L749,520.1797 L739,510.1797 L459,510.1797 " fill="#FBFB77" filter="url(#f1js0ldtt2aadq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M739,510.1797 L739,520.1797 L749,520.1797 L739,510.1797 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="465" y="528.6748">in this case we add the remaining</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="269" x="465" y="545.0264">relationship data (relationship strength, tags...)</text><polygon fill="#A80036" points="1024.5,580.2344,1034.5,584.2344,1024.5,588.2344,1028.5,584.2344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1030.5" y1="584.2344" y2="584.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="618.5" y="579.3779">network.Tags = relationship.tags</text><polygon fill="#A80036" points="1024.5,610.5859,1034.5,614.5859,1024.5,618.5859,1028.5,614.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1030.5" y1="614.5859" y2="614.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="618.5" y="609.7295">network.Strength = relationship.strength</text><path d="M443,634.5859 L443,660.5859 L765,660.5859 L765,644.5859 L755,634.5859 L443,634.5859 " fill="#FBFB77" filter="url(#f1js0ldtt2aadq)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M755,634.5859 L755,644.5859 L765,644.5859 L755,634.5859 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="449" y="653.0811">the resulting DTO is appended to the output network</text><polygon fill="#A80036" points="1024.5,688.2891,1034.5,692.2891,1024.5,696.2891,1028.5,692.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="611.5" x2="1030.5" y1="692.2891" y2="692.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="618.5" y="687.4326">network.Relationships.Append(subnetwork)</text><polygon fill="#A80036" points="354.5,732.6406,344.5,736.6406,354.5,740.6406,350.5,736.6406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348.5" x2="605.5" y1="736.6406" y2="736.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="360.5" y="731.7842">network</text><polygon fill="#A80036" points="75,762.9922,65,766.9922,75,770.9922,71,766.9922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="69" x2="337.5" y1="766.9922" y2="766.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="81" y="762.1357">response JSON</text><!--MD5=[6cf31ca2aaccf18bdb43cfbdfc7588f2]
@startuml

actor "Registered User" as UNU
participant "<<REST>>\nAPI" as API
participant "<<API Controller>>\nRelationshipsController" as RC
participant "<<Domain Service>>\nRelationshipService" as RS
participant "<<Domain>>\nPlayer" as P
participant "<<Domain>>\nRelationship" as R
participant "<<DTO>>\nNetworkFromPlayerPerspectiveDto" as NFPLDTO
participant "<<DTO>>\nPlayerDto" as PDTo
participant "<<Persistence>>\nPlayerRepository" as PR
participant "<<Persistence>>\nRelationshipRepository" as RR
participant "<<DbContext>>\nUnitOfWork" as UW

activate UNU
UNU -> API: PUT Player

activate API
API -> RC: GetNetwork(email,depth)
deactivate API
activate RC

RC->RS:GetNetworkAtDepthByEmail(email,depth)
activate RS

RS->PR:player=GetByEmailAsync(email)

RS- ->NFPLDTO:network=create(player.email,...)

loop until selected depth is achieved
RS->RR:relationships=GetRelationshipsFriendsById(playerId)
activate RR
deactivate RR

loop for every player's relationship
RS->PR:playerDest=GetByIdAsync(relationship.PlayerDest)

note over RS: this DTO only contains the basic data\n(user's email, name and relationship ID)
RS- ->NFPLDTO:subnetwork=create(playerDest.email,playerDest.name,relationship.id)

alt current relationship includes selected player
note over RS: in this case we add the remaining\nrelationship data (relationship strength, tags...)
RS->NFPLDTO:network.Tags = relationship.tags
RS->NFPLDTO:network.Strength = relationship.strength

end

note over RS: the resulting DTO is appended to the output network
RS->NFPLDTO:network.Relationships.Append(subnetwork)

end
end
RS- ->RC:network

deactivate RS


RC - -> UNU : response JSON
deactivate RC

@enduml

PlantUML version 1.2021.7(Sun May 23 13:40:07 BST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>